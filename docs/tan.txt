
           НЕПАРАМЕТРИЧЕСКИЕ  АЛГОРИТМЫ  ПРОГНОЗА  ПРОЦЕССОВ

           ПРИ ПОМОЩИ  ПОИСКА  АНАЛОГОВ  В  ИХ  ПРЕДЫСТОРИИ


       1. НАЗНАЧЕНИЕ.

       B большинстве практических задач прогноза случайных процессов или
    событий теория обьекта наблюдения неизвестна и единственной информацией
    о них служит короткая выборка наблюдений  Х( M * N ), в которой обычно
    М > N ( М - количество переменных, N - количество точек ). Требуется раз-
    делить выборку на интервалы ( кластеpы или паттерны) и усреднить значения
    переменных на каждом из них. По этим средним значениям требуется выбрать
    множество эффективных переменных, найти их значения на один паттерн
    вперед (т.е. найти паттерн будущего хода многомерного случайного процесса
    или будущее событие).
       Прогноз находится при помощи поиска и комплексирования аналогов А1,
    А2,А3,...,АN в предыстории. Комплексирование аналогов означает взвешен-
    ное суммирование прогнозов аналогов при помощи сплайнов.


       2. ПОСТАНОВКА ЗАДАЧИ ОПТИМИЗАЦИИ АЛГОРИТМОВ ПРОГНОЗА.

       Задана выборка данных наблюдения многомерного процесса Х( M * N ).
       Требуется найти оптимальную ширину паттернов h ( интервалы, на которые
    следует разделить данную выборку ), оптимальное количество комплексируемых
    аналогов F и оптимальный состав множества эффективных переменных m < M,
    соответствующий минимуму критерия перекрестного определения CV -> min,
    то есть требуется найти :

-               h  ->  h                                              CV
-               F  ->  F     , соответствующие  CV -> min :  CV = -------
-               m  ->  m                                             m

       Попутно  решается  вспомогательная задача оптимизации количества и
    состава множества переменных по частному критерию перекрестного опре-
    деления :
                                                                      CV
                m  ->  m     , соответствующие  CV -> min :  CV = -------
                                                                     n

    где :   m - количество переменных,
            N - количество паттернов,
       |  x | - ошибка прогноза.


       3.  КРАТКОЕ  ТЕОРЕТИЧЕСКОЕ  ОБОСНОВАНИЕ  СОЗДАНИЯ
                    И  ПРИМЕНЕНИЯ  АЛГОРИТМОВ.

       В отличие от традиционных дедуктивных методов ( действующие только в
    определенных системах), где количество переменных меньше количества пат-
    тернов ( M < N ) применяется индуктивные переборные методы поиска мини-
    мума критерия на плоскости  m - F  для ряда значений ширины паттернов h.
       Для каждой дискретной точки плоскости  m - F индивидуально находится
    оптимальный состав множества эффективных признаков по частному критерию
    CV -> min.
       Задача полного перебора всех вариантов облегчается тем, что величины
    h, m  и  F  могут принимать только ряд дискретных значений
                 h = 1, 2, 3, 4 и 5 строк
                 F = 1, 2, 3, 4 и 5 аналога
                 m < M  переменных
       На очереди  разработка многомерных алгоритмов, позволяющие значительно
    ( в 10 - 20 раз ) увеличить практически допустимый об"ем перебора.
       Полный перебор дает найлучшие результаты прогноза, который можно полу-
    чить на заданной выборке данных.
       С х о д и м о с т ь.  Как  известно,  алгоритмы,  основанные  на
    полном переборе не требуют исследования сходимости. Для новых многорядных
    ( итеррационных ) алгоритмов такое исследование потребуется.
       Ч у в с т в и т е л ь н о с т ь. Малые изменения начальных условий
    ( выборки данных) не должны существенно изменять выбор оптимального
    варианта ( h   , m   , F    ). Такая устойчивость показана на примерах
    прогноза дендрошкалы семи Байкальских деревьев и экономики ГДР [ 2 ].
    Экстремум характеристики CV ( m, F ) получается широким и единственным.
    Экстремальная зависимость имеет плавный характер - это важный эксперимен-
    тальный факт.
       Алгоритмы  применяется сейчас для разработки методики прогноза
    процессов в экологической системе Киевского водохранилища до и после
    аварии на Чернобыльской АЭС.


       4. БЛОК - СХЕМА  АЛГОРИТМОВ.

       Данное описание предназначается для двух алгоритмов :
       Первый из них заключается в поиске аналогов по матрице расстояний
    между паттернами, а второй - по матрице расстояний первых разностей между
    паттернами. Второй алгоритм основан на идее прогноза процесса по скорости
    его изменения ( т.е. по приращению переменных ).
       Блок-схема состоит из описания массивов и вектpов, ввода идентификатpов
    и массивов данных для соответствующих задач, вывода на печать всех иденти-
    фикаторов и обращения к основному модулю всего алгоритма. Значение иденти-
    фикатopа JCO дает возможность менять счетные задачи.


       5. ОБЩИЙ СПИСОК ИДЕНТИФИКАТОРОВ И МАССИВОВ.

       JCO = 1 -  ввод входного массива первой задачи;
       JCO = 2;

       JAMA = 0 - полный перебор ансамблей переменных;
       JAMA = 1 - режим поиска "ямы" в плоскости  m - F;
         M (MM) - количество переменных;
         N (NN) - количество точек наблюдения;
         JFM (JJFR) - количество аналогов;
         EPS = 1.E10 - верхний предел постоянной;
         MM1 = MM - 1;
         MM13 = MM - 3;
         М10 < 10,  N10 < 10 - кол-во элементов,выводимых на печать в строке;
         M21 = M10 + 1;
         N21 = N10 + 1;
         NN11 = NN - 1;
         NN12 = NN - 2;
         N11 = N - 1;
         MV - количество вводимых переменных;
         М11 = MV - 1;
         LLL - количество перебранных ансамблей;
         KM - текущее количество переменных;
         КМС - количество переменных в выходном ансамбле;
         JMM - индекс ансамбля   ( JMM = 1,(MV-1));
         LL = NN11 или NN12;

    JPRI = 0;
    JPRI = 0  - печать входных данных;
    JPRN = 0;
    JPRN = 0  - печать нормированных значений Х(ММ,NN);
    JC1  = 0;
    JC1  = 0;
    JRAS = 0;
    JRAS = 0  - печать массива квадратов расстояний RAS(LL,LL) в первом блоке;
    JRA2 = 0  - печать массива квадратов расстояний RAS(LL,LL) во втором блоке;
    JRA2 = 0;
    JIVM = 0;
    JIVM = 0  - печать массива аналогов;
    JXAB = 0;
    JXAB = 0  - печать массива pассчитанных пpогнозов ;
    JRR  = 0;
    JRR  = 0  - печать массива ошибки прогнозов;
    JCVJ = 0;
    JCVJ = 0  - печать вектора СVJ(J);
    JCV  = 0;
    JCV  = 0  - печать вектоа CV(I);
    JDX  = 0;
    JDX  = 0  - печать массива первых разностей  DX(MM,NN11);
    JIV  = 0;
    JIV  = 0  - печать адресов элементов вектора IV(MM);
    JIAM = 0;
    JIAM = 0  - печать векторов RIX(MM), RAX(MM);

      XV(MM,NN) - входной массив переменных;
      X(MM,NN) - текущий массив переменных;
      DX(MM,NN11) - массив первых разностей;
      XSN(NN) - вектор средних значений наблюдений переменных в паттернах;
      XSM(MM) - вектор средних значений переменных;
      RIX(MM) и RAX(MM) - вектора минимальных и максимальных значений
                переменных;
      CL(JJFR,NN11) - массив весовых коэффициентов;
      RAS(LL,LL) - массив квадратов расстояний;
      XA(MM,LL) - массив прогнозов, рассчитанных при помощи весовых коеф-
                фициентов и расстояний между аналогами;
      XB(MM,LL) - массив прогнозов, рассчитанных при помощи переменных
                при их переборе;
      DD(MM) -  вектор аналогов;
      IVM(JJFR,NN11) - массив адресов минимальных значений кpитеpия;
      IRC(MM) - вектор ансамблей переменных;
      IR(MM),IR1(MM),IR2(MM),IL(MM),IM(MM) - рабочиe векторa;
      IN(NN11),IK(NN) - рабочие вектора.
      IA(MM13,JJFR),IB(3,JJFR) - массивы адресов "плохих" переменных.


       6. ПРОГРАММЫ  ВВОДА  ЗАДАЧ.

       6-1.Н а з н а ч е н и е.
          Соответствующая задача вводится согласно значения JCO.

       6-2. О б р а ш е н и е.
          CALL TREE(JPRI,JFM,M20,N20,M,N,MM,NN,X,IV)

       6-3. И д е н т и ф и к а т о р ы, м а с с и в ы  и  в е к т о р а
          совпадают с общим списком.


       7. ПОДПРОГРАММЫ  PATXXX  и  PATDXD.

       7-1.  Н а з н а ч е н и е.
          Основные модули программ, выполняющие все операции алгоритмов.

       7-2. О б р а щ е н и е.
          CALL PATXXX(JFM,N,MV,N10,M10,JJFR,NN,NN11,MM,MM11,MM13,
         *XV,X,RIX,RAX,XSM,XSN,RAS,XA,XBT,DD,CL,CVJ,CVA,
         *IR,IR2,IL,IM,IV,IN,IK,IVM,IA)

          CALL PATDXD(JFM,N,MV,N10,M10,JJFR,NN,NN11,NN12,MM,MM11,MM13,
         *XV,X,RIX,RAX,DX,XSM,XSN,RAS,XA,XB,DD,CL,CVJ,CVA,
         *IR,IR2,IL,IM,IV,IN,IK,IVM,IA)

       7-3. И д е н т и ф и к а т о р ы,  м а с с и в ы  и  в е к т о р а
    совпадают с общим списком, кроме

       7-4. Б л о к - с х е м а   м о д у л я :
          Алгоритм просчитывается в двух режимах :
             JAMA = 0 - режим полного перебора ансамблей переменных,
             JAMA = 1 - режим поиска "ямы" и расчет прогноза переменных и
                        параметров для "ямы" на плоскости  m - F.
    Поиск "ямы" происходит по горизонталям на плоскости  m - F.
    В режиме JAMA=0 используется только первый блок, в котором присвоение
    CVI = 17.0 произвольно.
    Содержание тpех блоков алгоpитма :
          Пеpвый блок - поиск состава ансамбля пеpеменных пpи полном пеpебоpе
    всех ансамблей, соответствующего минимуму кpитepия пеpекpестного опpеде-
    ления CV в первом локальном минимуме ("яме").
          Втоpой блок - поиск паpаметpов и необходимых массивов для найденного
    ансамбля пеpеменных.
          Тpетий блок - пpосчет пpогнозов для этого ансамбля пеpеменных.

       7-5. О б р а щ е н и е  к  д р у г и м  п о д п р о г р а м м а м
           MATPRI, ...


       8. ПОДПРОГРАММЫ  NORX  и  .

       8-1. Н а з н а ч е н и е
            Нормирование входного массива  X(MM,NN) по размаху,расчет первой
    разности элементов массива и вывод на печать нормированных значений.

       8-2. О б р а щ е н и е.
          CALL NORX(JPRN,JDX,M20,N20,M,N,NN,NN11,X,DX,V,RIX,RAX,IV)

       8-3. И д е н т и ф и к а т о р ы, м а с с и в ы  и  в е к т о р а
    совпадают с общим списком.

       8-4. Р а с ч е т н ы е  ф о р м у л ы :

                   X(J,I) - RIX(J)                  J = 1,M;
          X(J,I) = ---------------  ,
                   RAX(J) - RIX(J)           где    I = 1,N;

                                                    K = 1,(N-1).
          DX(J,K) = X(J,K+1) - X(J,K),

       8-5. О б р а щ е н и е  к д р у г и м  п о д п р о г р а м м а м
          MATPRI  и   NORV


       9. ПОДПРОГРАММА  NORV.

       9-1. Н а з н а ч е н и е.
          Нормировка вектора V(NN) по размаху.

       9-2. О б р а ш е н и е.
          CALL NORV(N,RI,RA,NN,V)

       9-3. И д е н т и ф и к а т о р ы   и   в е к т о р :
          N(NN) - длина вектор V(NN);
          RI и RA - минимальное и максимальное значение ветора V(NN);
          V(NN) - входной вектор.

       9-4. Р а с ч е т н а я   ф о р м у л а :

                       V(I) - RI
                 V(I)= ----------  , где    I = 1,N .
                        RA  - RI


       10. ПОДПРОГРАММА  RAST.

       10-1.  Н а з н а ч е н и е.
          Расчет квадрата расстояний между строками массива DX(MM,NN).

       10-2. О б р а щ е н и е.
          CALL RAS1(JRAST,N10,M,N,MM,NN,DX,RAS,IN)
          CALL RAST(JRAST,N10,M,N,MM,NN,LL,X,RAS,IN)

       10-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы
    совпадают с общим списком.

       10-4. Р а с ч е т н а я   ф о р м у л а :
                                                             J = 1,M;
              RAS(K,L) =      ( DX(J,K) - DX(J,L))**2, где   K = 1,N;
                                                             L = 1,N.
          или
                                                             J = 1,M;
              RAS(K,L) =      ( X(J,K) - X(J,L))**2, где     K = 1,N-1;
                                                             L = 1,N-1.

       10-5. О б р а щ е н и е  к  д р у г и м  п о д п р о г р а м м а м
           MATPRI


       11. ПОДПРОГРАММА MINFR.

       11-1.  Н а з н а ч е н и е.
           Ранжирование по возрастанию строк массива RAS(NN11,NN11),
    расчет их обратных значений и запись их в СL(JJFR,LL),
    запись адресов ранжирования в массиве IVM(JJFR,LL).

       11-2. О б р а щ е н и е.
           CALL MINFR(JFR,N,JJFR,LL,NN,RAS,V,CL,IV,IVM)

       11-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
           JFR(JJFR), где JJFR < ( NN - 2 );
           LL  <  ( NN - 1 )  или  LL < ( NN - 2 );
           V(NN) - рабочий вектор;
           IV(LL) - рабочий вектор адресов элементов;
           Все остальные идентификаторы совпадают с общим списком.
    П р и м е ч а н и е :  В массиве IVM(JJFR,LL) адреса заносятся
    на единицу больше, так как запоминается сразу адреса аналога
    прогноза.

        11-4.  О б р а щ е н и е  к  д р у г и м  п о д п р о г р а м м а м
            RAI


        12. ПОДПРОГРАММА  МATPRI.

        12-1. Н а з н а ч е н и е.
            Печать  массива  входного  массива  X(MM,NN)  с  адресами его
    элементов.

        12-2. О б р а щ е н и е.
            CALL MATPRI(N1,N2,M20,M,N,MM,NN,X,IX)

        12-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы
            совпадают с общим списком, кроме
            N1 и N2 - границы печати значений переменных переменных;
            X(MM,NN) - входной массив подпрограммы;
            IX(MM) - вектор адресов переменных.


        13. ПОДПРОГРАММА  THREE.

        13-1. Н а з н а ч е н и е.
            Поиск поиск первого локального минимума среди соседних элементов
    массива AT(JJFR,3).

        13-2. О б р а щ е н и е
            CALL THREE(JJJ,JFM,CVI,JJFR,AT,JAMA)

        13-3. И д е н т и ф и к а т о р ы  и   м а с с и в ы :
            JJJ = 1 - поиск "ямы" по первым двум строкам массива;
            JJJ > 1 - поиск "ямы" по второй строке массива;
            JFM(JJFR) - количество столбцов в массиве AT(JJFR,3);
            СVI - значение ячейки " ЯМЫ ";
            JAMA - индекс наличия " ЯМЫ " в двух верхних строках AT(JJFR,3);
            AT(JJFR,3) - входной массив.

        13-4. Б л о к - с х е м а   п о д п р о г р а м м ы :
            13-4-1. Присвоение  JAMA = 0.
            13-4-2. Поиск " ЯМЫ " в верхнем углу (из четырех элементов) массива.
            13-4-3. Поиск " ЯМЫ " в первой строке массива( из 6 элементов ),
    начиная со второго элемента до предпоследнего  К = 2,(JFM - 1).
            13-4-4. Поиск " ЯМЫ " для первого элемента второй строки
    массива AT(JJFR,3) ( из шести элементов).
            13-4-5. Поиск " ЯМЫ " во второй строке массива AT(JJFR,3), начиная
    со второго элемента до предпоследнего  К = 2,(JFM - 1)
    ( из девяти элементов ).


       14. ПОДПРОГРАММЫ РАНЖИРОВАНИЯ.

       14-1. О б р а щ е н и е  и н а з н а ч е н и е
           СALL RAI(LV,LL,V,IV) - ранжирование по возрастанию элементов
    входного вектора V(LL) и адресов его элементов.
           CALL RAA(LV,LL,V,IV) - ранжирование по убыванию элементов входного
    вектора V(LL) и адресов его элементов.
           CALL RII(LV,LL,IV)   - ранжирование по возрастанию элементов
    входного массива  IV(LL).

       14-2. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
           LV(LL) - длина векторов V(LL),IV(LL);
           V(LL) и IV(LL) - входные вектора.


       15. ПОДПРОГРАММЫ MEDVEN  и MEDVEM.

       15-1. Н а з н а ч е н и е.
           Расчет средних значений по столбцам и строкам массива X(MM,NN).

       15-2. О б р а щ е н и е.
           CALL MEDVEN(M,N,MM,NN,X,XSN)
           CALL MEDVEM(M,N,MM,NN,X,XSM)

       15-3. И д е н т и ф и к а т о р ы  совпадают с общим списком.

       15-4. Р а с ч е т н ы е  ф о р м у л ы :

                           X(J,I)                  X(J,I)
            XSN(I) = ------------ ,   XSM(J) = ----------- , где   J = 1,M;
                         M                         N               I = 1,N.


       16.  ПОДПРОГРАММА  VEMPRI.

       16-1. Н а з н а ч е н и е.
           Печать вектора V(MM) и адресов его элементов. В каждой строчке
    печати должно быть не больше М10   ( < 10).

       16-2. О б р а щ е н и е.
           СALL VEMPRI(JIV,M10,M,MM,V,IV)

       16-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
           V(MM) - входной массив;
           IV(MM) - вектор адресов.
    Все остальные идентификаторы совпадают с общим списком.


                          Л и т е р а т у р а

       1. Ивахненко А.Г. Непрерывность и дискретность. - Киев : Наук. думка,
    1990. - 224 с. ил.
       2. Ивахненко А.Г.,Чаинская В.А.,Ивахненко Н.А. Непаpаметический
    комбинаторный алгоритм МГУА на операторах поиска аналогов. - Автоматика,
    1990, N 5, с.12-29.
       3. Налимов В.В. Анализ оснований экологического прогноза. Паттерн-анализ
    как ослабленный вариант прогноза. - МГУ : Человек и биосфера, 1983, N 2,
    с.115-140.
       4. Lorence E.N. Atmospheric predictability is revealed by naturaly
    occuring analogues. - J.Atmos.Sci., 1969, N 4, p.636-646.


