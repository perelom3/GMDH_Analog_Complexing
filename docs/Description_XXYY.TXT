
            ИНДУКТИВНЫЙ (ПЕРЕБОРНОЙ) АЛГОРИТМ ПРОГНОЗА

              СЛУЧАЙНЫХ СОБЫТИЙ (СИТУАЦИЙ) НА ОСНОВЕ

                     КОМПЛЕКСИРОВАНИЯ АНАЛОГОВ


       1. НАЗНАЧЕНИЕ.
      Прогноз одной или нескольких величин -  функций  ( априорно
назначенных исследователем) от остальных по короткой выборке  наб-
людений многомерного процесса. Прогноз находится при помощи поиска
и комплексирования аналогов в предыстории двух пространств : прос-
транства выходных переменных - функций  и  пространства  остальных
переменных  -  аргументов.  Комплексирование   аналогов   означает
взвешенное суммирование прогнозов аналогов при помощи сплайнов.

       2.  КРАТКОЕ  ТЕОРЕТИЧЕСКОЕ  ОБОСНОВАНИЕ  СОЗДАНИЯ
                    И  ПРИМЕНЕНИЯ  АЛГОРИТМОВ.
       Задана выборка данных наблюдений многомерного  процесса,  в
которой исследователь априорно назначает одни переменные  функция-
ми, а остальные - аргументами этих функции. Для прогноза указанных
функций требуется  найти  оптимальное  количество  комплексируемых
аналогов FY и оптимальный состав  множества  эффективных  выходных
величин  my < MY  при оптимальном количестве аналогов FX для аргу-
ментов и оптимальном составе аргументов   mx < M(MM), соответству
ющие минимуму критерия перекрестного  контроля   ( CV -> min ),
то есть требуется  найти fy  ->  FY   ,   my  -> MY и cоответству-
ющих им  f -> FX   ,  m -> m   при  СV -> min.
       При этом решается задача оптимизации количества  и  состава
множества как функции, так и аргументов по частному критерию пере-
крестного определения :
                m -> m    для  СV -> min ,
       где     my - количество выходных величин ( функций ),
                m - количество аргументов,
                fy,  f - количество аналогов,
                N - количество точек наблюдения ( паттернов ).
       Задача полного перебора ансамблей как функций, так и  аргу-
ментов, возможна лишь потому, что все эти пять значений могут при-
нимать лишь ограниченный ряд дискретных значений :
                my < MY ,  m < M,  a fy и f = 1,2,3,4 и 5 аналогов.
       Полный  перебор  значений,  даже  при  MY < 5,  M < 25  и
N < 100 даст  приемлемый  результат  прогноза  на  данной  выборке
наблюдений, если она адекватна  процессу, происходящему в  обьекте.
В алгоритме заложена верификация  ( оценка, проверка  )  прогнозов.
Ясно, что при плохой оценке интересующих  исследователя  прогнозов
величин необходимо удлинить выборку наблюдений (  увеличить  коли-
чество точек наблюдений ) ,  либо  изменить  граничное  количество
аналогов. Для улучшения прогнозов можно расширить список  перемен-
ных как выходных, так и аргументов, то  есть  расширить  априорную
информацию об обьекте или среде, в которой он находится. Необходимо
учитывать, что количество переменных  может  превышать  количество
точек наблюдений, то есть : N(NN) <  M (MM). Последнее обстоятель-
ство существенно отличает переборные методы  прогнозирования  про-
цессов. Кроме того, ни один  дедуктивный  метод  не  может  оценить
прогноз  одновременно  нескольких  функций,  что  также   является
неоспоримым преимуществом использования переборных методов. Полный
перебор дает найлучшие результаты прогноза, который
можно получить на заданной выборке данных.
       С х о д и м о с т ь.  Как  известно,  алгоритмы,   основан-
ные  на полном переборе, не требуют  исследования  сходимости. Для
новых многорядных ( итеррационных ) алгоритмов такое  исследование
потребуется.
        Ч у в с т в и т е л ь н о с т ь. Малые  изменения  началь-
ных условий ( выборки данных) не должны существенно изменять выбор
оптимального варианта (m   ,F    ). Такая устойчивость показана на
примерах прогноза дендрошкалы семи Байкальских деревьев и экономи-
ки ГДР [ 2 ]. Экстремум характеристики CV(m    ,F    )  получается
широким и единственным. Экстремальная  зависимость  имеет  плавный
характер - это важный экспериментальный факт.
       Алгоритмы применяются сейчас для разработки методики  прог-
ноза процессов в экологической системе Киевского водохранилища  до
и после аварии на Чернобыльской АЭС.

       3. БЛОК - СХЕМА  АЛГОРИТМA.
       Алгоритм написан на языке FORTRAN в виде  основного  модуля
(PROGRAM XXYY) и вспомогательных подпрограмм - модулей.
       Блок-схема PROGRAM XXYY  состоит  из  описания  массивов  и
вектоpов, ввода идентификатоpов и массивов данных для соответству
ющих задач, вывода на печать всех идентификаторов  и  обращения  к
основному модулю всего алгоритма.
       Значение  идентификатopа  JCO   дает   возможность   менять
счетные задачи.

       4. ОБЩИЙ СПИСОК ИДЕНТИФИКАТОРОВ И МАССИВОВ.
         MY (MMY) - количество функциональных переменных;
         MV,M (MM)   - количество независимых переменных (аргументов);
         N  (NN)  - количество   точек   наблюдения   (количество
                    паттернов);
         JFM (JJFR)  - количество аналогов;
         EPS = 1.E10 - верхний предел постоянной;
         MM11 = MM - 1;
         MM12 = MM - 2;
         NN1 = NN + 1;
         NN11 = NN - 1;
         NN12 = NN - 2;
         N11 = N - 1;
         MV  - количество вводимых переменных (аргументов);
         М11 = MV - 1;
         LLL - количество перебранных ансамблей;
         KM  - текущее количество переменных;
         КМС - количество переменных в выходном ансамбле;
         JMM - индекс ансамбля   ( JMM = 1,(MV-1));
         LL  <  ( NN - 1 )  или  LL < ( NN - 2 );
         POR - коеффициент расширения изменения порога прогноза
               паттерна;
    JP  = 0 - печать размерности входных данных,
              параметров работы алгоритма,
              оптимального количества аналогов,
              оптимальных ансамблей функций  и  аргументов,
              вектора  оценок  верификации   прогнозов,
              прогноза функции,
              минимального и  максимального  значения  функции для
              сравнения с прогонозом.
функций, ансамблей функций, входных
аргументов;
    JP   = 1 - кроме того, печать нормированных значений функций и
               аргументов Х(ММ,NN),
               критерия   перекрестного    контроля    оптимальных
               ансамблей;
    JP1  = 1 - печать адресов ансамблей переменных,
               текущих параметров при переборе ансамблей,
               массива квадратов  расстояний  RAS(LL,LL)  в
               первом блоке,
               печать массива квадратов расстояний  RAS(LL,LL)  во
               втором блоке,
               массива аналогов,
               массива pассчитанных пpогнозов,
               массива ошибки прогнозов,
               печать вектора СVJ(J),
               печать вектора CV(I),
               печать адресов элементов вектора IV(MM),
               печать векторов RIY(MMY), RAY(MMY),
      YV(MMY,NN),Y(MMY,NN) - массивы выходных МY пеpеменных;
      XV(MM,NN1) - массив входных M переменных;
      X(MM,NN)   - текущий массив переменных;
      XSN(NN)    - вектор средних значений наблюдений переменных
                   в паттернах;
      XSM(MM)    - вектор средних значений переменных;
      RIY(MMY) и RAY(MMY) -  вектора  минимальных  и  максимальных
                   значений функций;
      OC(MMY)    - вектор верификации прогнозов функции;
      CL(JJFR,NN)- массив весовых коэффициентов;
      RAS(NN,NN) - массив квадратов расстояний;
      XA(MM,NN)  - массив  прогнозов,  рассчитанных  при  помощи
                   весовых коеффициентов и расстояний между
                   аналогами;
      XB(MM,NN)  - массив  прогнозов,  рассчитанных  при  помощи
                   аргументов при переборе их ансамблей;
      RY(MMY),SY(MMY),CLX(MM),RSX(MM),SX(MM),XN(NN1) - pабочие
                   вектоpа;
      CVJ(MM)    - вектор  для  расчета  критерия  перекрестного
                   определения;
      CVI        - значение искомого критерия;
      YPR(MMY)   - вектоp искомых пpогнозов;
      XPR(MM)    - вектоp вектор аргументов, для котоpых пpогно-
                   зиpуются значения функции;
      IVM(JJFR,NN) - массив адресов минимальных значений кpитеpия;
      IR(MM),IR1(MM),IR2(MM),IL(MM),IM(MMY),IMY(MMY),IAX(NN),
      IMX(MM),IY(MMY),IN(NN)     - рабочиe векторa;
      IA(MM12,JJFR) - массив адресов "плохих" переменных.

       5. ПРОГРАММЫ  ВВОДА  ЗАДАЧ.
       5-1.Н а з н а ч е н и е.
       Соответствующая задача вводится согласно значения JCO.
       5-2. О б р а ш е н и е.
       CALL DATINY ()
       5-3. И д е н т и ф и к а т о р ы,  м а с с и в ы   и
       в е к т о р а   совпадают с общим списком.

       6. ПОДПРОГРАММА   PATXYY.
       6-1.  Н а з н а ч е н и е.
       Основной  модуль  программы,   выполняющий   все   операции
       алгоритма.
       6-2.  О б р а щ е н и е.
       call PATXYY (JFM,MVY,MV,N,MY10,M10,POR,
      *JJFR,MMY,MM,MM11,NN,NN1,YV,Y,YPR,YSN,XV,XPR,X,RIY,RAY,RSX,
      *CLX,XN,RAS,XA,XB,CL,CVJ,RY,SY,
      *IMX,IR1,IL,IM,IY,IMY,IN,IVM,IAX,IA)
       6-3. И д е н т и ф и к а т о р ы,  м а с с и в ы   и
       в е к т о р а   совпадают с общим списком.
       6-4. Б л о к - с х е м а  м о д у л я.
       6-4-1. Расширение массива  аргументов  XV(MM,NN1)  на  один
паттерн, для которого и осуществляется прогноз выходных величин.
       6-4-2. Нормировка  массива  выходных  величин  Y(MMY,NN)  и
фиксация минимальных (RIY (MMY)) и максимальных (RAY(MMY)) их значе
ний ( обращение к модулю NORXXX).
       6-4-3. Нормировка массива аргументов XV(MM,NN1) (обращение к
модулю NORXXX).
       6-4-4. Полный перебор ансамблей  функций  и  аргументов  до
значения критерия CVII и фиксация параметров селекции (  обращение
к RBYY ).
       6-4-5. Расчет параметров сплайнов из аргументов -  заполне-
ние вектора весоеых коэффициентов CLX(MM).
       6-4-6. Прогноз функций по сплайнам из аргументов и их печать
на листинге.
       6-4-7. Верификация (оценка, проверка) прогнозов :
       - по отклонению их  от  среднего  значения  соответствующей
выходной функции;
       - по ограничению на заданое значение POR  на минимальные  и
максимальные значение возможного прогноза.
       6-4-8. Разнормировка прогнозов функции.
       6-4-9. Вывод  на  листинг  минимальных  и   максимальных
значений функции для сравнения их с прогнозами.

       7. ПОДПРОГРАММА NORXXX.
       7-1. Н а з н а ч е н и е
       Нормирование входного массива по размаху ( от 0 до 1).
       7-2. О б р а щ е н и е.
       call NORXXX(JP,JPRN,M10,M,N,MM,NN,X,V,RIX,RAX,IV)
       7-3. И д е н т и ф и к а т о р ы, м а с с и в ы   и
       в е к т о р а   совпадают с общим списком, кромe
           JP  =  1  -  заполнение  векторов  RIX(MM)  и   RAX(MM)
граничными значениями переменных;
           X(MM,NN) - входной массив модуля;
           RIX(MM)  и  RAX(MM)  -   вектора   граничных   значений
переменных;
           V(MM),IV(MM) - рабочие вектора.
       7-4. Р а с ч е т н ы е  ф о р м у л ы :

                   X(J,I) - RIX(J)                  J = 1,M;
          X(J,I) = ───────────────            ,где
                   RAX(J) - RIX(J)                  I = 1,N.

       8. ПОДПРОГРАММА  NORV.
       8-1. Н а з н а ч е н и е.
          Нормировка вектора V(NN) по размаху.
       8-2. О б р а ш е н и е.
          CALL NORV(LV,RI,RA,ML,V)
       8-3. И д е н т и ф и к а т о р ы   и   в е к т о р :
       LV(ML) - длина вектора V(ML);
       RI и RA - минимальное и максимальное значение вектора V(ML);
       V(ML) - входной вектор.
       8-4. Р а с ч е т н а я   ф о р м у л а :
                       V(I) - RI
                 V(I)= ─────────   , где I = 1,LV.
                        RA  - RI

       9. ПОДПРОГРАММА DICH1.
       9-1.  Н а з н а ч е н и е.
          Модуль двоичного счетчика.
       9-2. О б р а щ е н и е.
          call DICH1(JQ,MV,LV,ML,IV,IV1)
       9-3. И д е н т и ф и к а т о р ы
       JQ - число, которое необходимо перевести в двоичный код;
       MV - рассчитываемое количество единиц в векторе IV(ML);
       LV(ML) - длина вектора;
       IV(ML) - бинарный вектор нулей и единиц;
       IV1(ML) - вектор натуральных чисел, соответствующих IV(ML).

       10. ПОДПРОГРАММА RBYY.
       10-1. Н а з н а ч е н и е.
       Полный перебор ансамблей функций и аргументов до значения
критерия CVII и фиксация параметров селекции.
       10-2. О б р а щ е н и е.
       call RBYY (KL,KMC,JFC,CVII,JFM,MVY,MY,MV,N,M10,
      *JJFR,MMY,MM,MM12,NN,NN1,YV,Y,YSN,XV,X,RAS,XA,XB,CL,CVJ,
      *IR,IR1,IL,IM,IY,IMY,IN,IVM,IA)
       10-3. И н д е н т и ф и к а т о р ы  и  м а с с и в ы
совпадают с общим списком, кроме
        JFC(JFM) - количество аналогов в оптимальном ансамблей.


       11. ПОДПРОГРАММА  RASTXX.
       11-1.  Н а з н а ч е н и е.
       Расчет квадрата расстояний между паттернами (строками)
 входного массива.
       11-2. О б р а щ е н и е.
       call RASTXX(JRAS,N10,M,N,MM,NN,LL,X,RAS,IN)
       11-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы
совпадают с общим списком.
       11-4. Р а с ч е т н а я   ф о р м у л а :
                           M                                 J = 1,M;
              RAS(K,L) =    ( X(J,K) - X(J,L))**2,    где    K = 1,N;
                           j                                 L = 1,N.

       12. ПОДПРОГРАММА FRMIN.
       12-1. Н а з н а ч е н и е.
       Расчет весовых коеффициентов и адресов аналогов.
       12-2. О б р а щ е н и е.
           call FRMIN (JFR,N,JJFR,NN,RAS,V,CL,IV,IVM)
       12-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
           JFR(JJFR), где JJFR < (NN - 2);
           V(NN) - рабочий вектор;
           IV(NN) - рабочий вектор адресов элементов;
           Все остальные идентификаторы совпадают с общим списком.
       12-4. Б л о к  -  с х е м а   м о д у л я.
       12-4-1.Ранжирование по возрастанию строк массива RAS(NN,NN).
       12-4-2.Расчет их обратных значений и запись их в СL(JJFR,NN).
       12-4-3.Запись адресов ранжирования в массиве IVM(JJFR,NN).

       13. ПОДПРОГРАММА  RASXV.
       13-1. Н а з н а ч е н и е.
           Нахождение аналогов паттерну XPR(MM) в выборке X(MM,NN).
       13-2. О б р а щ е н и е.
           call RASXV(JRAS,JFC,M,N,MM,NN,X,XPR,RSX,CLX,IAX,IN)
       13-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы .
           X(MM,NN) и XPR(MM) - входной массив и вектор модуля.
           RSX(NN) - вектор квадратов расстояний,
           CLX(NN) - вектор обратных значений вектора RSX(NN),
           IAX(NN) - вектор адресов аналогов.
           Oстальные идентификаторы и массивы совпадают с общим
           списком.

       13-4. Б л о к  -  с х е м а   м о д у л я.
       13-3-1. Расчет вектора RSX(NN) квадратов расстояний паттерна
XPR(NN) до паттернов массива X(MM,NN) и печать этого вектора.
       13-3-2. Ранжировка вектора RSX(NN) и адресов по возрастанию
его значений.
       13-3-3. Расчет обратных значений RSX(NN) в векторе CLX(NN).
       13-5. Р а с ч е т н а я   ф о р м у л а.
                   N                                J = 1,M;
       RSX(I) =    ( XPR(J) - X(J,I))**2,    где    I = 1,N.
                   i

       14. ПОДПРОГРАММА  OCENKA.
       14-1.  Н а з н а ч е н и е.
       Верификация прогнозов.
       14-2. О б р а щ е н и е.
       call OCENKA (POR,MY,N,MMY,NN,Y,YPR,SY,RY,IY,IMY,ME)
       14-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы
       совпадают с общим списком.
       14-3. Б л о к  -  с х е м а   м о д у л я.
       14-3-1. Расчет вариации.
       14-3-2. Оценка входного вектора шириной порога.

       15. ПОДПРОГРАММЫ РАНЖИРОВАНИЯ.
       15-1. О б р а щ е н и е  и  н а з н а ч е н и е
       call RA0IV (LV,ML,IV) - ранжирование по возрастанию  элемен-
тов входного вектора IV(ML).
       call RA1IV(LV,ML,V,IV) - ранжирование по возрастанию элементов
входного вектора V(ML) и адресов его элементов.
       call RAA (LV,ML,V,IV) - ранжирование по убыванию
элементов входного  массива V(ML) и адресов его элементов.
       15-2. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
       LV(ML) - длина векторов V(ML),IV(ML);
       V(ML) и IV(ML) - входные вектора.

       16. ПОДПРОГРАММА  МATPRMF.
       16-1. Н а з н а ч е н и е.
       Печать входного массива X(MM,NN) с адресами его переменных.
       16-2. О б р а щ е н и е.
       call MATPRMF (JM,M1,M2,N,MM,NN,X,IM)
       16-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы
       совпадают с общим списком, кроме
           JM = 0  - вектор  IM(MM)  сохраняет  адреса  входных
           переменных;
           JM = 1 - печать переменных от M1 до M2;
           M1 и M2 - границы печати значений переменных;
           X(MM,NN) - входной массив подпрограммы;
           IM(MM) - вектор адресов переменных.

       18.  ПОДПРОГРАММЫ VEMPRI и VEIPRI.
       18-1. Н а з н а ч е н и е.
       Печать векторов V(ML) и IV(ML) и их элементов.
       В каждой строке печати должно быть не больше L10 (<10).
       18-2. О б р а щ е н и е.
           call VEIPRI(JIV,L10,L,ML,V,IV)
           call VEMPRI(JIV,L10,L,ML,V,IV)
       18-3. И д е н т и ф и к а т о р ы  и  м а с с и в ы :
           V(ML), IV(ML) - входные вектора ;
           IV(ML) - вектор адресов.
           Все остальные идентификаторы совпадают с общим списком.

       19. ВЫХОДНАЯ ИНФОРМАЦИЯ НА ЛИСТИНГЕ.
       После загрузки алогоритма на печать выдаются %
       а) исходные параметры,
       б) выходной паттерн аргументов,
       в) массив функций,
       г) массив аргументов,
       д) индекс задачи JCO,
       е) границы массивов и векторов,
       ж) текущие параметры алгоритма,
       з) параметры режима работы,
       и) минимальное значение критерия перекрестного определения при
полном переборе ансамблей функций и аргументов,
       к) оптимальные ансамбли аргументов и функций;
       л) коеффициент вариации,
       м) верификация прогнозов по коеффициенту вариации,
       н) прогноз функции, ее минимальное и максимальное значение для
выбранного ансамбля.
Примечание% пункты а) - з) задаются в подпрограмме DATIN,
            пункты и) - н) задаются в основной программе PROGRAM.

       20. ОбЛАСТЬ ПРИМЕНЕНИЯ ПРОГРАММЫ.
       Прогнозирование процессов для принятия решения  в  разнооб-
разных научных и прикладных областях. В сочетании с Вашими знания-
ми и профессиональным опытом расчеты  быстро  и  эффективно  дадут
возможность оценить и проверить предположения о закономерностях  в
обьекте исследования.

       21. СРЕДА ФУНКЦИОНИРОВАНИЯ.
       Персональный компьютер типа IBM PC  AT/XT  под  управлением
операционной системы MS-DOS версии 2.10 и выше. Обьем  оперативной
памяти должен быть не менее 512 килобайт.
      Система может быть загружена как с твердого, так и с гибкого
магнитного диска. Для ее функционирования необходимо наличие файла
данных, записанного в определенном  формате,  который  задается  в
подпрограмме DATINY.

                       Л и т е р а т у р а.
1. Ивахненко А.Г. Начала теории нечеткого переборного  распознава-
   ния и прогнозирования. - Препринт 9132. - ИК АН УССР, 1991.
2. Ивахненко А.Г. Индуктивный (переборной)  метод  прогнозирования
   случайных многомерных процессов и событий при помощи комплекси-
   рования прогнозов аналогов.- 1991.
3. Ивахненко А.Г. Непрерывность и дискретность. - Киев : Наук. думка,
   1990. - 224 с. ил.
4. Ивахненко А.Г.,Чаинская  В.А.,Ивахненко  Н.А.  Непаpаметический
   комбинаторный алгоритм  МГУА  на  операторах  поиска  аналогов.
   - Автоматика, 1990, N 5, с.12-29.
5. Налимов В.В. Анализ оснований экологического прогноза. Паттерн-
   -анализ как ослабленный вариант прогноза. -  МГУ  :  Человек  и
   биосфера, 1983, N 2, с.115-140.
6. Ивахненко А.Г. Метод последовательного  опробывания  (перебора)
   кластеризации - кандидатов по критериям дифференциального типа.
   Ежегодник @Распознавание,  классификация,  прогноз@  /под  ред.
   Ю.И. Журавлева., М., Статистика,  1989., с.126-158.
7. Lorence E.N. Atmospheric predictability is revealed by naturaly
   occuring analogues. - J.Atmos.Sci., 1969, N 4, p.636-646.
